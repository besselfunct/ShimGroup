(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     88829,       2089]
NotebookOptionsPosition[     88302,       2073]
NotebookOutlinePosition[     88675,       2089]
CellTagsIndexPosition[     88632,       2086]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Press", " ", "Shift"}], "+", 
    RowBox[{"Enter", " ", "to", " ", "Execute", " ", "Code"}]}], " ", "*)"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"UI", " ", "Design"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Clear", " ", "Previous", " ", "Variables"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Initialize", " ", "Variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TRPLcheck", " ", "=", " ", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TRELcheck", " ", "=", " ", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELSpectrumcheck", " ", "=", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EQELumcheck", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ND10EQELumcheck", " ", "=", " ", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SolutionPLcheck", " ", "=", " ", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SampleID", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"date", " ", "=", " ", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELwavelength", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"380", ",", "780", ",", "4"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"shortID", "=", "\"\<Iy980EWw\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TRPLFile", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TRELFile", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELSpectrumFile", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EQELumFile", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ND10EQELumFile", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SolutionABSFile", "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SolutionPLFile", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Prompt", " ", "User", " ", "to", " ", "Specify", " ", "Input", " ", 
     "Files", " ", "and", " ", "Sample", " ", "Identifying", " ", 
     "Information"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ChoiceDialog", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Grid", "[", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Sample ID:\>\"", ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "SampleID", "]"}], ",", "String"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Date (YYMMDD):\>\"", ",", " ", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "date", "]"}], ",", "String"}], "]"}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<TRPL File\>\"", ",", 
           RowBox[{"FileNameSetter", "[", 
            RowBox[{"Dynamic", "[", "TRPLFile", "]"}], "]"}], ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"TRPLFile", "\[NotEqual]", "\"\<\>\""}], "]"}], "]"}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<TREL File\>\"", ",", 
           RowBox[{"FileNameSetter", "[", 
            RowBox[{"Dynamic", "[", "TRELFile", "]"}], "]"}], ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"TRELFile", "\[NotEqual]", "\"\<\>\""}], "]"}], "]"}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<EL Spectrum\>\"", ",", 
           RowBox[{"FileNameSetter", "[", 
            RowBox[{"Dynamic", "[", "ELSpectrumFile", "]"}], "]"}], ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"ELSpectrumFile", "\[NotEqual]", " ", "\"\<\>\""}], 
             "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<EQE/Luminance File\>\"", ",", 
           RowBox[{"FileNameSetter", "[", 
            RowBox[{"Dynamic", "[", "EQELumFile", "]"}], "]"}], ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"EQELumFile", "\[NotEqual]", "\"\<\>\""}], "]"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<ND10 EQE/Luminance File\>\"", ",", 
           RowBox[{"FileNameSetter", "[", 
            RowBox[{"Dynamic", "[", "ND10EQELumFile", "]"}], "]"}], ",", " ", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"ND10EQELumFile", "\[NotEqual]", "\"\<\>\""}], "]"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Solution Absorbance File\>\"", ",", 
           RowBox[{"FileNameSetter", "[", 
            RowBox[{"Dynamic", "[", "SolutionABSFile", "]"}], "]"}], ",", " ", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"SolutionABSFile", "\[NotEqual]", "\"\<\>\""}], "]"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Solution PL File (MUST BE .PRN)\>\"", ",", 
           RowBox[{"FileNameSetter", "[", 
            RowBox[{"Dynamic", "[", "SolutionPLFile", "]"}], "]"}], ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"SolutionPLFile", "\[NotEqual]", "\"\<\>\""}], "]"}], 
            "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", " ", 
      RowBox[{"Modal", "->", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"WindowSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"500", ",", "350"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Decision", " ", "Tree"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"TRPL", " ", "Check"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TRPLFile", " ", "\[NotEqual]", "  ", "\"\<\>\""}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TRPLdata", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"TRPLFile", ",", "\"\<TSV\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "TRPL", " ", "Data", " ", "Manipulation", " ", "and", " ", 
         "Plotting"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"Head", "@", 
            RowBox[{
             RowBox[{"TRPLdata", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", " ", 
          "\"\<String\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TRPLtimescale", "=", 
           RowBox[{"TRPLdata", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", " ", 
          RowBox[{"TRPLdatarow", " ", "=", " ", "11"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TRPLtimescale", "=", 
           RowBox[{"TRPLdata", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"TRPLdatarow", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", "TRPLdatarow", ";", "\n", 
       RowBox[{"TRPLdecay", " ", "=", " ", 
        RowBox[{"TRPLdata", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"TRPLdatarow", ";;"}], ",", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TRPLprompt", " ", "=", " ", 
        RowBox[{"TRPLdata", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"TRPLdatarow", ";;"}], ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TRPLchannel", " ", "=", " ", 
        RowBox[{"TRPLdata", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"TRPLdatarow", ";;"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Extract", " ", "Timescale"}], " ", "-", " ", 
          RowBox[{
          "Character", " ", "codes", " ", "were", " ", "the", " ", "best", 
           " ", "way", " ", "I", " ", "found", " ", "to", " ", "do", " ", 
           "this"}]}], ",", " ", 
         RowBox[{
         "but", " ", "there", " ", "might", " ", "be", " ", "a", " ", 
          "better", " ", "one"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"nsperchannel", " ", "=", " ", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"FromCharacterCode", "[", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"ToCharacterCode", "[", "TRPLtimescale", "]"}]}], ",", 
            " ", 
            RowBox[{
             RowBox[{
              RowBox[{"#", " ", "\[Equal]", "46"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", ">", "47"}], "&&", 
                RowBox[{"#", "<", "58"}]}], ")"}]}], " ", "&"}]}], "]"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Apply", " ", "Timescale"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"TRPLchannel", " ", "=", " ", 
        RowBox[{"TRPLchannel", "*", "nsperchannel"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TRPLMaxTime", "=", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"TRPLchannel", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"TRPLdecay", ",", 
             RowBox[{"Max", "@", "TRPLdecay"}]}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NormTRPLdecay", "=", 
        RowBox[{"N", "[", 
         RowBox[{"TRPLdecay", "/", 
          RowBox[{"Max", "@", "TRPLdecay"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"InterpTRPL", "=", 
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"TRPLchannel", ",", "NormTRPLdecay"}], "}"}], "//", 
          "Transpose"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eulerTime", "=", 
        RowBox[{"x", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"InterpTRPL", "[", "x", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"N", "@", "1"}], "/", "E"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "TRPLMaxTime", ",", 
             RowBox[{"TRPLMaxTime", "+", "20"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TRPLPlot", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"TRPLchannel", ",", "TRPLdecay"}], "}"}], "//", 
           "Transpose"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"TRPLdecay", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", " ", ">", " ", 
                    RowBox[{
                    RowBox[{"Max", "[", "TRPLdecay", "]"}], "*", "0.01"}]}], 
                    " ", "&"}], ")"}]}]}], "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", "nsperchannel"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"TRPLdecay", ",", 
                    RowBox[{
                    RowBox[{"Nearest", "[", 
                    RowBox[{"TRPLdecay", ",", 
                    RowBox[{
                    RowBox[{"Max", "[", "TRPLdecay", "]"}], "*", "0.01"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", "nsperchannel"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", "TRPLdecay", "]"}], ",", 
               RowBox[{"Max", "[", "TRPLdecay", "]"}]}], "}"}]}], "}"}]}], 
          ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Time (ns)\>\"", ",", "\"\<Counts (a.u.)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<TRPL\>\""}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"\"\<1/e time=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Round", "[", 
                  RowBox[{"eulerTime", ",", "0.1"}], "]"}], "]"}], "<>", 
                "\"\<ns\>\""}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.6", ",", "0.8"}], "}"}], "]"}]}], "]"}], ",", 
             "14"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"TRPLPlot", "=", "\"\<No Data\>\""}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"TREL", " ", "Check"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TRELFile", " ", "\[NotEqual]", "  ", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TRELdata", " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{"TRELFile", ",", "\"\<TSV\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "TREL", " ", "Data", " ", "Manipulation", " ", "and", " ", 
         "Plotting"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"Head", "@", 
            RowBox[{
             RowBox[{"TRELdata", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", " ", 
          "\"\<String\>\""}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TRELtimescale", "=", 
            RowBox[{"TRELdata", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ";", " ", 
           RowBox[{"TRELdatarow", " ", "=", " ", "11"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TRELtimescale", "=", 
            RowBox[{"TRELdata", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
           RowBox[{"TRELdatarow", "=", "3"}]}], ")"}]}], "]"}], ";", "\n", 
       RowBox[{"TRELdecay", " ", "=", " ", 
        RowBox[{"TRELdata", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"TRELdatarow", ";;"}], ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TRELchannel", " ", "=", " ", 
        RowBox[{"TRELdata", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"TRELdatarow", ";;"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Extract", " ", "Timescale"}], " ", "-", " ", 
          RowBox[{
          "Character", " ", "codes", " ", "were", " ", "the", " ", "best", 
           " ", "way", " ", "I", " ", "found", " ", "to", " ", "do", " ", 
           "this"}]}], ",", " ", 
         RowBox[{
         "but", " ", "there", " ", "might", " ", "be", " ", "a", " ", 
          "better", " ", "one"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ELnsperchannel", " ", "=", " ", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"FromCharacterCode", "[", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"ToCharacterCode", "[", "TRELtimescale", "]"}]}], ",", 
            " ", 
            RowBox[{
             RowBox[{
              RowBox[{"#", " ", "\[Equal]", "46"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", ">", "47"}], "&&", 
                RowBox[{"#", "<", "58"}]}], ")"}]}], " ", "&"}]}], "]"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Apply", " ", "Timescale"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"TRELchannelRT", " ", "=", " ", 
        RowBox[{"TRELchannel", "*", "ELnsperchannel"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MaxTREL", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Extract", "[", 
            RowBox[{"TRELchannelRT", ",", 
             RowBox[{"Position", "[", 
              RowBox[{"TRELdecay", ",", 
               RowBox[{"Max", "@", "TRELdecay"}]}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Max", "@", "TRELdecay"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Max10TREL", "=", 
        RowBox[{"0.1", "*", 
         RowBox[{"MaxTREL", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Max10TRELTime", "=", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"TRELchannelRT", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"TRELdecay", ",", 
             RowBox[{
              RowBox[{"Nearest", "[", 
               RowBox[{"TRELdecay", ",", "Max10TREL"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Max90TREL", "=", 
        RowBox[{"0.9", "*", 
         RowBox[{"MaxTREL", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Max90TRELTime", "=", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"TRELchannelRT", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"TRELdecay", ",", 
             RowBox[{
              RowBox[{"Nearest", "[", 
               RowBox[{"TRELdecay", ",", "Max90TREL"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MaxTRELTime", "=", 
        RowBox[{"MaxTREL", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"InterpTREL", "=", 
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"TRELchannelRT", ",", "TRELdecay"}], "}"}], "//", 
          "Transpose"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Rise0", "=", 
        RowBox[{"x", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"InterpTREL", "[", "x", "]"}], "\[Equal]", "Max10TREL"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "MaxTRELTime"}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Rise1", "=", 
        RowBox[{"x", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"InterpTREL", "[", "x", "]"}], "\[Equal]", "Max90TREL"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "MaxTRELTime"}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"RiseTime", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{"Rise0", "-", "Rise1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Fall0", "=", 
        RowBox[{"x", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"InterpTREL", "[", "x", "]"}], "\[Equal]", "Max90TREL"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "MaxTRELTime", ",", 
             RowBox[{"Max", "@", "TRELchannelRT"}]}], "}"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Fall1", "=", 
        RowBox[{"x", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"InterpTREL", "[", "x", "]"}], "\[Equal]", "Max10TREL"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "MaxTRELTime", ",", 
             RowBox[{"Max", "@", "TRELchannelRT"}]}], "}"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"FallTime", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{"Fall0", "-", "Fall1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TRELPlot", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"TRELchannelRT", ",", "TRELdecay"}], "}"}], "//", 
           "Transpose"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"TRELdecay", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", " ", ">", " ", 
                    RowBox[{
                    RowBox[{"Max", "[", "TRELdecay", "]"}], "*", "0.01"}]}], 
                    " ", "&"}], ")"}]}]}], "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", "ELnsperchannel"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"TRELdecay", ",", 
                    RowBox[{
                    RowBox[{"Nearest", "[", 
                    RowBox[{"TRELdecay", ",", 
                    RowBox[{
                    RowBox[{"Max", "[", "TRELdecay", "]"}], "*", "0.01"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", "ELnsperchannel"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", "TRELdecay", "]"}], ",", 
               RowBox[{"Max", "[", "TRELdecay", "]"}]}], "}"}]}], "}"}]}], 
          ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Time (ns)\>\"", ",", "\"\<Counts (a.u.)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<TREL\>\""}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"\"\<Rise Time=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Round", "[", 
                  RowBox[{"RiseTime", ",", "0.1"}], "]"}], "]"}], "<>", 
                "\"\<ns\>\"", "<>", "\"\<\\nFall Time=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Round", "[", 
                  RowBox[{"FallTime", ",", "0.1"}], "]"}], "]"}], "<>", 
                "\"\<ns\>\""}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "14"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"TRELPlot", "=", "\"\<No Data\>\""}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"EL", " ", "Spectrum", " ", "Check"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ELSpectrumFile", " ", "\[NotEqual]", "  ", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ELSpectrumdata", " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{"ELSpectrumFile", ",", " ", "\"\<TSV\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "EL", " ", "Spectrum", " ", "Peak", " ", "Position", " ", "Plot"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"CleanELSpecData", " ", "=", " ", 
        RowBox[{"ELSpectrumdata", "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<NaN\>\"", "\[Rule]", "0"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MaxEL", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"MaxEL", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Vertical Position\>\"", ",", "\"\<Voltage\>\"", ",", 
           "\"\<Wavelength (nm)\>\"", ",", "\"\<Max Intensity\>\""}], "}"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "@", 
             RowBox[{"CleanELSpecData", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}]}], "\[Equal]", 
            "0"}], ",", "\[IndentingNewLine]", "Nothing", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"MaxEL", ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"(*", " ", 
               RowBox[{"Vertical", " ", "Position", " ", "in", " ", "List"}], 
               "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"CleanELSpecData", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}], ",", 
                   RowBox[{"Max", "@", 
                    RowBox[{"CleanELSpecData", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}]}]}], "]"}], 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Voltage", " ", "Value"}], " ", "*)"}], 
               RowBox[{"CleanELSpecData", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Wavelength", " ", "Value"}], " ", "*)"}], 
               RowBox[{"Around", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ELwavelength", "[", 
                   RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"CleanELSpecData", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "@", 
                    RowBox[{"CleanELSpecData", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}]}]}], "]"}], 
                    "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"2", "*", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"ELwavelength", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"CleanELSpecData", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "@", 
                    RowBox[{"CleanELSpecData", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}]}]}], "]"}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
                    RowBox[{"ELwavelength", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"CleanELSpecData", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"CleanELSpecData", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Max", "@", 
                    RowBox[{"CleanELSpecData", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}]}], ")"}], 
                    "/", "2"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}]}]}],
                 "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Actual", " ", "Maxiumum", " ", "Value"}], " ", 
                "*)"}], 
               RowBox[{"Max", "@", 
                RowBox[{"CleanELSpecData", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}]}]}], 
              "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", "CleanELSpecData", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"FWHMPlot", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MaxEL", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", ";;"}], ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"MaxEL", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", ";;"}], ",", "3"}], "]"}], "]"}]}], "}"}], "//", 
           "Transpose"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MaxEL", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"MaxEL", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Max", "@", 
                   RowBox[{"MaxEL", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "3"}], "]"}], "]"}]}], ",", 
                  RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}], 
                "<>", "\"\<nm\>\""}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
             "14"}], "]"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<EL Spectrum FWHM\>\""}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ExpMaxEL", "=", 
        RowBox[{"Max", "@", 
         RowBox[{"MaxEL", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"2", ";;"}], ",", "3"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"EL", " ", "Spectrum", " ", "Plotting"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ELSpectrumPlot", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"ELSpectrumdata", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", ";;"}], ",", 
              RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"380", ",", "780"}], "}"}]}], ",", 
          RowBox[{"PlotLabels", "\[Rule]", 
           RowBox[{"ELSpectrumdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Wavelength (nm)\>\"", ",", "\"\<Intensity (a.u.\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<EL Spectrum\>\""}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Max", "@", 
                   RowBox[{"MaxEL", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "3"}], "]"}], "]"}]}], ",", 
                  RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}], 
                "<>", "\"\<nm\>\""}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.30", ",", "0.75"}], "}"}], "]"}]}], "]"}], ",", 
             "14"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{
       RowBox[{"FWHMPlot", "=", "\"\<No Data\>\""}], ";", 
       RowBox[{"ELSpectrumPlot", "=", "\"\<No Data\>\""}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"EQE", " ", "Luminance", " ", "Check"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"EQELumFile", " ", "\[NotEqual]", "  ", "\"\<\>\""}], " ", "&&",
        " ", 
       RowBox[{"ND10EQELumFile", "\[NotEqual]", " ", "\"\<\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"EQE", " ", "Plots", " ", "and", " ", "Manipulation"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EQELumdata", " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{"EQELumFile", ",", " ", "\"\<TSV\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ND10EQELumdata", " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{"ND10EQELumFile", ",", " ", "\"\<TSV\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EQELumdata", " ", "=", " ", 
        RowBox[{"EQELumdata", "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<NaN\>\"", "\[Rule]", "0"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ND10EQELumdata", " ", "=", " ", 
        RowBox[{"ND10EQELumdata", "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<NaN\>\"", "\[Rule]", "0"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"V1", "=", 
        RowBox[{"EQELumdata", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"2", ";;"}], ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"V2", " ", "=", " ", 
        RowBox[{"ND10EQELumdata", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"2", ";;"}], ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MaxEQE", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "@", 
           RowBox[{"EQELumdata", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}]}], ",", 
          RowBox[{"Max", "@", 
           RowBox[{"ND10EQELumdata", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}]}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"VatMaxEQE", " ", "=", " ", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"V1", ",", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"EQELumdata", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "@", 
              RowBox[{"EQELumdata", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}]}]}], "]"}]}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LumatMaxEQE", " ", "=", " ", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{
           RowBox[{"EQELumdata", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", ";;"}], ",", "7"}], "]"}], "]"}], ",", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"EQELumdata", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", ";;"}], ",", "2"}], "]"}], "]"}], ",", 
             "VatMaxEQE"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Use", " ", "Interpolation", " ", "to", " ", "find", " ", "90", "%", 
         "EQE", " ", "value"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"EQEInterp", "=", 
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", ";;"}], ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}]}], "}"}], "//", 
          "Transpose"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Vat90EQE", "=", 
        RowBox[{"x", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"EQEInterp", "[", "x", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"MaxEQE", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", "0.9"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "VatMaxEQE", ",", 
             RowBox[{"VatMaxEQE", "+", "1"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EQEPlot", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V1", ",", 
                 RowBox[{"EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "10"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V2", ",", 
                 RowBox[{"ND10EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
              RowBox[{"PlotMarkers", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FilledDiamond]\>\"", ",", " ", "18"}], 
                "}"}]}]}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"EQELumdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "11"}], "]"}], "]"}]}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EQELumdata", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"EQELumdata", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "11"}], "]"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"\"\<Max EQE=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Round", "[", 
                  RowBox[{"MaxEQE", ",", "0.1"}], "]"}], "]"}], "<>", 
                "\"\<%\>\"", "<>", "\"\<\\n  V at MaxEQE=\>\"", "<>", 
                RowBox[{"ToString", "[", "VatMaxEQE", "]"}], "<>", 
                "\"\<V\>\""}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.75", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
             "14"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Luminance", " ", "Plot"}], " ", "*)"}], "\n", 
       RowBox[{"PeakLuminance", "=", 
        RowBox[{"Max", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "@", 
            RowBox[{"EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", ";;"}], ",", "7"}], "]"}], "]"}]}], ",", 
           RowBox[{"Max", "@", 
            RowBox[{"ND10EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", ";;"}], ",", "7"}], "]"}], "]"}]}]}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"LuminancePlot", " ", "=", " ", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V1", ",", 
                 RowBox[{"EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "7"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "10"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V2", ",", 
                 RowBox[{"ND10EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "7"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
              RowBox[{"PlotMarkers", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FilledDiamond]\>\"", ",", " ", "18"}], 
                "}"}]}]}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"EQELumdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "7"}], "]"}], "]"}]}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"\"\<Lum @ MaxEQE=\>\"", "<>", 
                RowBox[{"ToString", "[", "LumatMaxEQE", "]"}], "<>", 
                "\"\<cd/\!\(\*SuperscriptBox[\(m\), \(2\)]\)\>\""}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.6", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
             "14"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Power", " ", "Efficiency"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"MaxPCE", "=", 
        RowBox[{"Max", "@", 
         RowBox[{"EQELumdata", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"2", ";;"}], ",", "13"}], "]"}], "]"}]}]}], ";", "\n", 
       RowBox[{"VatMaxPCE", "=", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"V1", ",", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"EQELumdata", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", ";;"}], ",", "13"}], "]"}], "]"}], ",", 
             "MaxPCE"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PowerEfficiencyPlot", " ", "=", " ", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V1", ",", 
                 RowBox[{"EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "13"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "10"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V2", ",", 
                 RowBox[{"ND10EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "13"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
              RowBox[{"PlotMarkers", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FilledDiamond]\>\"", ",", " ", "18"}], 
                "}"}]}]}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"EQELumdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "13"}], "]"}], "]"}]}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"\"\<Max PCE=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Round", "[", 
                  RowBox[{
                   RowBox[{"Max", "@", 
                    RowBox[{"EQELumdata", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "13"}], "]"}], "]"}]}], ",", 
                   "0.1"}], "]"}], "]"}], "<>", "\"\<lm/W\>\"", "<>", 
                "\"\<\\n  V@MaxPCE=\>\"", "<>", 
                RowBox[{"ToString", "[", "VatMaxPCE", "]"}]}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.75", ",", "0.75"}], "}"}], "]"}]}], "]"}], ",", 
             "14"}], "]"}]}]}], "]"}]}], ";", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Current", " ", "Density"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"CurrentDensityPlot", " ", "=", " ", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V1", ",", 
                 RowBox[{"EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "8"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "10"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V2", ",", 
                 RowBox[{"ND10EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "8"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
              RowBox[{"PlotMarkers", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FilledDiamond]\>\"", ",", " ", "18"}], 
                "}"}]}]}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"EQELumdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "8"}], "]"}], "]"}]}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"\"\<\!\(\*SubscriptBox[\(J\), \(max\)]\)=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Max", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Max", "@", 
                    RowBox[{"EQELumdata", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "8"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Max", "@", 
                    RowBox[{"ND10EQELumdata", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "8"}], "]"}], "]"}]}]}], 
                   "}"}]}], "]"}], "<>", 
                "\"\<mA/\!\(\*SuperscriptBox[\(cm\), \(2\)]\)\>\""}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
             "14"}], "]"}]}]}], "]"}]}], ";", "\n", 
       RowBox[{"(*", " ", "Current", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"CurrentPlot", " ", "=", " ", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListLogPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V1", ",", 
                 RowBox[{"EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "3"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "10"}], "}"}]}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], ",", 
            RowBox[{"ListLogPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V2", ",", 
                 RowBox[{"ND10EQELumdata", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;"}], ",", "3"}], "]"}], "]"}]}], "}"}], "//",
                "Transpose"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
              RowBox[{"PlotMarkers", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FilledDiamond]\>\"", ",", " ", "18"}], "}"}]}],
               ",", 
              RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"EQELumdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Jmax", "=", 
        RowBox[{"Max", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "@", 
            RowBox[{"EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", ";;"}], ",", "8"}], "]"}], "]"}]}], ",", 
           RowBox[{"Max", "@", 
            RowBox[{"ND10EQELumdata", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", ";;"}], ",", "8"}], "]"}], "]"}]}]}], "}"}]}]}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{
       RowBox[{"EQEPlot", "=", "\"\<No Data\>\""}], ";", 
       RowBox[{"LuminancePlot", "=", "\"\<No Data\>\""}], ";", 
       RowBox[{"PowerEfficiencyPlot", "=", "\"\<No Data\>\""}], ";", 
       RowBox[{"CurrentDensityPlot", "=", "\"\<No Data\>\""}], ";", 
       RowBox[{"CurrentPlot", "=", "\"\<No Data\>\""}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"ND10", " ", "EQE", " ", "Luminance", " ", "Check"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ND10EQELumcheck", " ", "\[Equal]", " ", "True"}], ",", " ", 
       RowBox[{"ND10EQELumFile", "=", 
        RowBox[{"SystemDialogInput", "[", 
         RowBox[{"\"\<FileOpen\>\"", ",", " ", 
          RowBox[{
          "WindowTitle", "\[Rule]", 
           "\"\<Select the ND10 EQE/Luminance File\>\""}]}], "]"}]}], ",", 
       "Nothing"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Solution", " ", "PL", " ", "Check"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SolutionABSFile", "\[NotEqual]", "\"\<\>\""}], "&&", 
       RowBox[{"SolutionPLFile", "\[NotEqual]", "\"\<\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SolABSdata", " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{"SolutionABSFile", ",", " ", "\"\<CSV\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SolPLdata", " ", "=", " ", 
        RowBox[{"Import", "[", "SolutionPLFile", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Solution", " ", 
         RowBox[{"Absorbance", "/", "PL"}], " ", "Plot"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]min", "=", "400"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]max", "=", "800"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]minpos", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"SolABSdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "\[Lambda]min"}],
             "]"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]maxpos", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"SolABSdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "\[Lambda]max"}],
             "]"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ABSOnlyPlot", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SolABSdata", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", ";;"}], ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"SolABSdata", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", ";;"}], ",", "2"}], "]"}], "]"}]}], "}"}], "//", 
           "Transpose"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Lambda]min", ",", "\[Lambda]max"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"SolABSdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"\[Lambda]minpos", ";;", "\[Lambda]maxpos"}], ",", 
                   "2"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"SolABSdata", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"\[Lambda]minpos", ";;", "\[Lambda]maxpos"}], ",", 
                   "2"}], "]"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Wavelength (nm)\>\"", ",", "\"\<Absorbance (a.u.)\>\""}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Account", " ", "for", " ", "PL", " ", "Data", " ", "Import", " ", 
         "Error"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"CleanSolPLdata", " ", "=", " ", 
        RowBox[{"SolPLdata", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Dimensions", "@", "SolPLdata"}], ")"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}], "]"}], 
         "]"}]}], ";", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Calculate", " ", "Normalization", " ", "Factor"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"NormSolPLdata", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Max", "@", 
                  RowBox[{"SolABSdata", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Lambda]minpos", ";;", "\[Lambda]maxpos"}], ",",
                     "2"}], "]"}], "]"}]}], ")"}], "\[Equal]", 
                RowBox[{"x", "*", 
                 RowBox[{"(", 
                  RowBox[{"Max", "@", 
                   RowBox[{"CleanSolPLdata", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ")"}]}]}], ",", 
               "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], ")"}], "*", 
         RowBox[{"CleanSolPLdata", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PLMax", " ", "=", " ", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{
           RowBox[{"CleanSolPLdata", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"CleanSolPLdata", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "@", 
              RowBox[{"CleanSolPLdata", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], "]"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PLFWHM", " ", "=", " ", 
        RowBox[{"2", "*", 
         RowBox[{"Abs", "[", 
          RowBox[{"PLMax", " ", "-", " ", 
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{
              RowBox[{"CleanSolPLdata", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"CleanSolPLdata", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Nearest", "[", 
                  RowBox[{
                   RowBox[{"CleanSolPLdata", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{
                    RowBox[{"CleanSolPLdata", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"CleanSolPLdata", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", "PLMax"}], 
                    "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ")"}]}], 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PLPlot", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"CleanSolPLdata", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", "NormSolPLdata"}],
             "}"}], "//", "Transpose"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MinMax", "[", 
              RowBox[{"CleanSolPLdata", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"MinMax", "[", "NormSolPLdata", "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Combined", " ", "Plots"}], " ", "*)"}], "\n", 
       RowBox[{"ABSPlot", " ", "=", " ", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ABSOnlyPlot", ",", "PLPlot"}], "}"}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{
               "\"\<PL \!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Around", "[", 
                   RowBox[{"PLMax", ",", "PLFWHM"}], "]"}], ",", 
                  RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}], 
                "<>", "\"\<nm\>\""}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.75", ",", "0.75"}], "}"}], "]"}]}], "]"}], ",", 
             "12"}], "]"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<UV-Vis/PL\>\""}]}], "]"}]}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"ABSPlot", "=", "\"\<No Data\>\""}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\n", 
   TemplateBox[{
    "InterpolatingFunction","dmval",
     "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \\\"0.`\\\", \\\"}\\\"}]\\) \
lies outside the range of data in the interpolating function. Extrapolation \
will be used.\"",2,21,1,31824164334478076976,"Local"},
    "MessageTemplate"], "\n", 
   TemplateBox[{
    "InterpolatingFunction","dmval",
     "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \\\"0.`\\\", \\\"}\\\"}]\\) \
lies outside the range of data in the interpolating function. Extrapolation \
will be used.\"",2,21,2,31824164334478076976,"Local"},
    "MessageTemplate"], "\n", 
   TemplateBox[{
    "Callout","copos",
     "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"Automatic\\\", \\\"}\\\"}]\\) is not \
a valid position for the placement of callouts.\"",2,22,3,
     31824164334478076976,"Local"},
    "MessageTemplate"], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Plot", " ", "Grid"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"summaryplots", "=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"EQEPlot", ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{
             "\"\<SampleID:\>\"", "<>", "SampleID", "<>", "\"\<\\nDate:\>\"", 
              "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"DateObject", "[", "date", "]"}], ",", 
                RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], 
             ",", "14"}], "]"}], ",", "LuminancePlot"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "ELSpectrumPlot", ",", "ABSPlot", ",", "PowerEfficiencyPlot"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"CurrentDensityPlot", ",", "CurrentPlot", ",", "FWHMPlot"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"TRPLPlot", ",", " ", "TRELPlot"}], "}"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1920", ",", "1080"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PopupWindow", "[", 
     RowBox[{"\"\<Click Here for Summary Plots\>\"", ",", "summaryplots", ",", 
      RowBox[{"WindowSize", "\[Rule]", "All"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CreateDialog", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", "summaryplots", "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Item", "[", 
          RowBox[{
           RowBox[{"DefaultButton", "[", "]"}], ",", 
           RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"WindowSize", "\[Rule]", "All"}], ",", 
      RowBox[{"WindowTitle", "\[Rule]", "\"\<Summary Plots\>\""}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Export", " ", "Plots", " ", "as", " ", "PNGs"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"EQELumplotlist", "=", 
     RowBox[{"{", 
      RowBox[{
      "EQEPlot", ",", "LuminancePlot", ",", "PowerEfficiencyPlot", ",", 
       "CurrentDensityPlot", ",", "CurrentPlot"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EQELumplotnamelist", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<EQEPlot\>\"", ",", "\"\<LuminancePlot\>\"", ",", 
       "\"\<PowerEfficiencyPlot\>\"", ",", "\"\<CurrentDensityPlot\>\"", ",", 
       "\"\<CurrentPlot\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exportdir", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TRPLplotcheck", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TRELplotcheck", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELSpectrumplotcheck", "=", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EQELumplotcheck", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AbsPLplotcheck", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"summaryplotcheck", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exportall", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imgoptions", "=", 
     RowBox[{"{", 
      RowBox[{"1200", ",", 
       RowBox[{"1200", "*", "0.618"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ChoiceDialog", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Grid", "\[IndentingNewLine]", "[", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Export Directory\>\"", ",", 
           RowBox[{"FileNameSetter", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "exportdir", "]"}], ",", 
             "\"\<Directory\>\""}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\"\<Plots to Export\>\"", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Select All\>\"", ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", "exportall", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Summary Plot\>\"", ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"summaryplotcheck", "||", "exportall"}], "]"}], "]"}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<TRPL Plot\>\"", ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"(", 
              RowBox[{"TRPLplotcheck", "||", "exportall"}], ")"}], "]"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<TREL Plot\>\"", ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"(", 
              RowBox[{"TRELplotcheck", "||", "exportall"}], ")"}], "]"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<EL Spectrum Plot\>\"", ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"(", 
              RowBox[{"ELSpectrumplotcheck", "||", "exportall"}], ")"}], 
             "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<EQE/Luminance Plots\>\"", ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"(", 
              RowBox[{"EQELumplotcheck", "||", "exportall"}], ")"}], "]"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Solution Absorbance/PL Plot\>\"", ",", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"(", 
              RowBox[{"AbsPLplotcheck", "||", "exportall"}], ")"}], "]"}], 
            "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", " ", 
      RowBox[{"Modal", "->", "True"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"exportall", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TRPLplotcheck", "=", "True"}], ";", 
       RowBox[{"TRELplotcheck", "=", "True"}], ";", 
       RowBox[{"ELSpectrumplotcheck", "=", "True"}], ";", 
       RowBox[{"EQELumplotcheck", "=", "True"}], ";", 
       RowBox[{"AbsPLplotcheck", "=", "True"}], ";", 
       RowBox[{"summaryplotcheck", "=", "True"}]}], ",", 
      "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"TRPLplotcheck", "\[Equal]", "True"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "exportdir", "<>", "\"\<\\\\\>\"", "<>", "SampleID", "<>", "date", 
         "<>", "\"\<TRPLplot.png\>\""}], ",", "TRPLPlot", ",", 
        RowBox[{"ImageSize", "\[Rule]", "imgoptions"}]}], "]"}], ",", 
      "Nothing"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"TRELplotcheck", "\[Equal]", "True"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "exportdir", "<>", "\"\<\\\\\>\"", "<>", "SampleID", "<>", "date", 
         "<>", "\"\<TRELplot.png\>\""}], ",", "TRELPlot", ",", 
        RowBox[{"ImageSize", "\[Rule]", "imgoptions"}]}], "]"}], ",", 
      "Nothing"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ELSpectrumplotcheck", "\[Equal]", "True"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "exportdir", "<>", "\"\<\\\\\>\"", "<>", "SampleID", "<>", "date", 
         "<>", "\"\<ELSpectrumplot.png\>\""}], ",", "ELSpectrumPlot", ",", 
        RowBox[{"ImageSize", "\[Rule]", "imgoptions"}]}], "]"}], ",", 
      "Nothing"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EQELumplotcheck", "\[Equal]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
          "exportdir", "<>", "\"\<\\\\\>\"", "<>", "SampleID", "<>", "date", "<>", 
           RowBox[{"EQELumplotnamelist", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
          RowBox[{"EQELumplotlist", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "imgoptions"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"Dimensions", "[", "EQELumplotlist", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ",", "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"AbsPLplotcheck", "\[Equal]", "True"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "exportdir", "<>", "\"\<\\\\\>\"", "<>", "SampleID", "<>", "date", 
         "<>", "\"\<AbsPLplot.png\>\""}], ",", "ABSPlot", ",", 
        RowBox[{"ImageSize", "\[Rule]", "imgoptions"}]}], "]"}], ",", 
      "Nothing"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"summaryplotcheck", "\[Equal]", "True"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "exportdir", "<>", "\"\<\\\\\>\"", "<>", "SampleID", "<>", "date", 
         "<>", "\"\<SummaryPlot.png\>\""}], ",", "summaryplots", ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1920", ",", "1080"}], "}"}]}]}], "]"}], ",", "Nothing"}], 
     "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7846523476959314`*^9, 3.78465235424759*^9}, {
  3.7846535895700083`*^9, 3.7846535986213756`*^9}, {3.784653639407916*^9, 
  3.784653646541844*^9}},ExpressionUUID->"85e1a2a9-fb8b-45b8-96aa-\
0017df676a29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Prepare", " ", "Export"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"t", "=", 
     RowBox[{"{", 
      RowBox[{"SampleID", ",", "date", ",", 
       RowBox[{"DateList", "[", "]"}], ",", "MaxEQE", ",", "ExpMaxEL", ",", 
       "PeakLuminance", ",", "LumatMaxEQE", ",", "VatMaxEQE", ",", 
       RowBox[{"Around", "[", 
        RowBox[{"PLMax", ",", "PLFWHM"}], "]"}], ",", "MaxPCE", ",", 
       "VatMaxPCE", ",", "Jmax", ",", "eulerTime", ",", "RiseTime", ",", 
       "FallTime", ",", "ELSpectrumdata", ",", "EQELumdata", ",", 
       "ND10EQELumdata", ",", "TRPLdecay", ",", "TRELdecay", ",", 
       "summaryplots"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CloudPut", "[", 
     RowBox[{"summaryplots", ",", "SampleID", ",", 
      RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7836292050056453`*^9, 3.78362920964723*^9}, {
   3.7836300937667656`*^9, 3.783630096446134*^9}, {3.7836302379207306`*^9, 
   3.78363024182315*^9}, {3.783631275751659*^9, 3.7836315527185187`*^9}, {
   3.783633295182291*^9, 3.783633391024661*^9}, {3.7836334506557927`*^9, 
   3.783633512383525*^9}, 3.7836335436075277`*^9, {3.7836336383087516`*^9, 
   3.783633687041693*^9}, {3.7836337298241267`*^9, 3.7836337312361097`*^9}, {
   3.783693191020508*^9, 3.783693198966257*^9}, {3.783693238466349*^9, 
   3.783693241347644*^9}, {3.7836932852807693`*^9, 3.783693399442254*^9}, {
   3.7836936205440435`*^9, 3.783693637158148*^9}, {3.783693715924147*^9, 
   3.7836938073443613`*^9}, {3.783693859060542*^9, 3.7836938963917875`*^9}, {
   3.783693992753834*^9, 3.783693997177006*^9}, {3.7836942837882047`*^9, 
   3.7836944913504515`*^9}, {3.783695215917276*^9, 3.783695412946827*^9}, {
   3.7836960630347033`*^9, 3.7836960705984755`*^9}, {3.783696164882636*^9, 
   3.7836961707459555`*^9}, {3.7836962864906893`*^9, 
   3.7836966916271477`*^9}, {3.783701180201909*^9, 3.7837013579662247`*^9}, {
   3.7837013918975534`*^9, 3.783701437236493*^9}, {3.7837014721534667`*^9, 
   3.7837014994111843`*^9}, {3.7837019260778093`*^9, 3.783701997757394*^9}, {
   3.783702044600127*^9, 3.7837020783349104`*^9}, {3.783702136838662*^9, 
   3.7837021743997297`*^9}, {3.7837027715542116`*^9, 
   3.7837028679843736`*^9}, {3.7837028993370776`*^9, 3.783702909956705*^9}, {
   3.7837029409553733`*^9, 3.783703005743698*^9}, {3.7837032551594067`*^9, 
   3.783703335533738*^9}, {3.7837046954472046`*^9, 3.783704719256814*^9}, {
   3.7837048524346914`*^9, 3.783704877489339*^9}, {3.7837049215051966`*^9, 
   3.7837049791547728`*^9}, {3.7837051031367674`*^9, 
   3.7837051462316227`*^9}, {3.783705197183846*^9, 3.783705269643262*^9}, {
   3.783705331500291*^9, 3.7837053319142413`*^9}, {3.7837053997324924`*^9, 
   3.7837053998431635`*^9}, {3.7837055265070133`*^9, 3.783705611117452*^9}, {
   3.7837057566368756`*^9, 3.7837058369070063`*^9}, {3.783705990653154*^9, 
   3.78370601701563*^9}, {3.783706100476735*^9, 3.783706140084696*^9}, {
   3.7837063867224073`*^9, 3.783706471515934*^9}, {3.7837122658962636`*^9, 
   3.7837123928777914`*^9}, {3.7843079199656816`*^9, 
   3.7843081198598957`*^9}, {3.7843113275035715`*^9, 
   3.7843113722836423`*^9}, {3.784311441026002*^9, 3.78431150635157*^9}, {
   3.7843115555691094`*^9, 3.7843115666325626`*^9}, {3.784311673568403*^9, 
   3.7843116923172064`*^9}, {3.7843121830941496`*^9, 
   3.7843122684718847`*^9}, {3.7843277440990725`*^9, 
   3.7843278656879606`*^9}, {3.784328270420357*^9, 3.7843284391256795`*^9}, {
   3.784328475130884*^9, 3.7843285687337675`*^9}, {3.7843291929996185`*^9, 
   3.7843292198662634`*^9}, {3.784329462053775*^9, 3.78432952718382*^9}, {
   3.7843303372081733`*^9, 3.784330612466419*^9}, {3.7843306470748973`*^9, 
   3.7843307984985948`*^9}, {3.7843308848994174`*^9, 
   3.7843310419879155`*^9}, {3.784331153491894*^9, 3.7843311773113976`*^9}, 
   3.7843314965891705`*^9, {3.784334462629179*^9, 3.7843344749691815`*^9}, {
   3.784373525586419*^9, 3.7843735777122254`*^9}, 3.7843736322168274`*^9, {
   3.784376046771519*^9, 3.7843760602799463`*^9}, {3.7843761177943416`*^9, 
   3.784376127525814*^9}, {3.7843762812570477`*^9, 3.7843762957921925`*^9}, {
   3.7843792811276493`*^9, 3.784379291141741*^9}, {3.7843897253228483`*^9, 
   3.7843897531198597`*^9}, {3.7843975628247833`*^9, 3.7843975755792*^9}, {
   3.7843982002577705`*^9, 3.784398276726405*^9}, {3.7843987570852623`*^9, 
   3.78439878266433*^9}, {3.784398822593606*^9, 3.7843988254275575`*^9}, {
   3.784399532033208*^9, 3.7843997739894114`*^9}, {3.7843998325340676`*^9, 
   3.784399997982586*^9}, {3.784400039396654*^9, 3.784400054478044*^9}, {
   3.784400091463059*^9, 3.784400136240197*^9}, {3.7844002613278303`*^9, 
   3.784400262664101*^9}, {3.784400368946478*^9, 3.7844003930883565`*^9}, 
   3.7844033251123285`*^9, 3.784403374454541*^9, 3.7844034058508253`*^9, {
   3.7844034925831585`*^9, 
   3.7844035029818974`*^9}},ExpressionUUID->"75ff7eb9-df07-4eb2-bd2d-\
9da7b056d76b"],

Cell[BoxData[
 RowBox[{"(*", " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "TO", " ", "DO", "\[IndentingNewLine]", "1.", " ", "Secondary", " ", 
     "Plots", "\[IndentingNewLine]", "\t", 
     RowBox[{"a", ".", " ", "Peak"}], " ", "Position", " ", "as", " ", "a", 
     " ", "Function", " ", "of", " ", "Voltage", " ", "for", " ", "EL"}], " ",
     "-", " ", 
    RowBox[{
    "Done", "\[IndentingNewLine]", "2.", " ", "Extract", " ", "FOM", " ", 
     "and", " ", "add", " ", "to", " ", "plots", " ", "using", " ", "Epilog", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"a", ".", " ", "Peak"}], " ", "Position", " ", "and", " ", 
     "FWHM", " ", "for", " ", "EL"}], " ", "-", " ", 
    RowBox[{"Done", "\[IndentingNewLine]", "\t", 
     RowBox[{"b", ".", " ", "Peak"}], " ", "Position", " ", "and", " ", 
     "FWHM", " ", "for", " ", "PL"}], " ", "-", " ", 
    RowBox[{"Done", "\[IndentingNewLine]", "\t", 
     RowBox[{"c", ".", " ", "Max"}], " ", "EQE"}], " ", "-", " ", 
    RowBox[{"Done", "\[IndentingNewLine]", "\t", 
     RowBox[{"d", ".", " ", 
      RowBox[{"Luminance", " ", "@", " ", "Max"}]}], " ", "EQE"}], " ", "-", 
    " ", 
    RowBox[{"Done", "\[IndentingNewLine]", "\t", 
     RowBox[{"e", ".", " ", 
      RowBox[{"Voltage", " ", "@", " ", "Max"}]}], " ", "EQE"}], " ", "-", 
    " ", 
    RowBox[{"Done", "\[IndentingNewLine]", "\t", 
     RowBox[{"f", ".", " ", 
      RowBox[{"Voltage", " ", "@", " ", "90"}]}], "%", " ", "Max", " ", 
     "EQE"}], " ", "-", " ", "Done", " ", "-", " ", 
    RowBox[{
    "Need", " ", "to", " ", "add", " ", "Epilog", "\[IndentingNewLine]", "\t", 
     RowBox[{"g", ".", " ", "Max"}], " ", "Current", " ", "Density"}], " ", 
    "-", " ", 
    RowBox[{"Done", "\[IndentingNewLine]", "\t", 
     RowBox[{"h", ".", " ", "Max"}], " ", "Power", " ", "Efficiency"}], " ", 
    "-", " ", 
    RowBox[{"Done", "\[IndentingNewLine]", "\t", 
     RowBox[{"i", ".", " ", "Absorbance"}], " ", "Peak", " ", "Positions"}]}],
    ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FWHM", " ", "and", " ", "Peak", " ", "Ratios"}], " ", "-", 
       " ", 
       RowBox[{"May", " ", "be", " ", "difficult"}]}], "..."}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"j", ".", " ", "Rise"}], " ", "Time", " ", "for", " ", "EL"}], 
    " ", "-", " ", 
    RowBox[{"Done", "\[IndentingNewLine]", "\t", 
     RowBox[{"k", ".", " ", "Fall"}], " ", "Time", " ", "for", " ", "EL"}], 
    " ", "-", " ", 
    RowBox[{"Done", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"l", ".", " ", "1"}], "/", "e"}], " ", "time", " ", "for", " ", 
     "TRPL"}], " ", "-", " ", 
    RowBox[{
    "Done", "\[IndentingNewLine]", "3.", " ", "Organize", " ", "FOM"}]}], ",",
    " ", 
   RowBox[{
   "and", " ", "raw", " ", "data", " ", "into", " ", "list", " ", "of", " ", 
    "lists"}], ",", " ", 
   RowBox[{
    RowBox[{"and", " ", "upload", " ", "to", " ", "group", " ", "databin"}], 
    " ", "-", " ", 
    RowBox[{
    "Need", " ", "higher", " ", "upload", " ", "limit", " ", "for", " ", 
     RowBox[{"databin", ".", " ", "Put"}], " ", "plots", " ", "as", " ", 
     "cloud", " ", "objects", "\[IndentingNewLine]", "\t", 
     RowBox[{"a", ".", " ", "Create"}], " ", "Cloud", " ", "Object", " ", 
     "with", " ", "defined", " ", "URL", " ", "and", " ", "Header"}], " ", 
    "-", " ", 
    RowBox[{
    "Separate", " ", "From", " ", "Script", "\[IndentingNewLine]", "\t", 
     RowBox[{"b", ".", " ", "Grab"}], " ", "the", " ", "Cloud", " ", "Object",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"c", ".", " ", "Use"}], " ", "AppendTo", " ", "to", " ", "add", 
     " ", "data", " ", "to", " ", "the", " ", "Object", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"d", ".", " ", "Reupload"}], " ", "modified", " ", "Cloud", " ", 
     "Object", " ", "to", " ", "the", " ", "same", " ", "URL", 
     "\[IndentingNewLine]", "4.", " ", "Error", " ", "Checking"}], " ", "-", 
    " ", 
    RowBox[{
    "Particularly", " ", "for", " ", "cases", " ", "where", " ", "not", " ", 
     "all", " ", "data", " ", "is", " ", "present", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"a", ".", " ", "Need"}], " ", "to", " ", "handle", " ", "case", 
     " ", "where", " ", "only", " ", "one", " ", "PL", " ", "or", " ", "Abs", 
     " ", "file", " ", "is", " ", "present", "\[IndentingNewLine]", "\t", 
     RowBox[{"b", ".", " ", "Need"}], " ", "to", " ", "handle", " ", "case", 
     " ", "where", " ", "only", " ", "one", " ", "EQELum", " ", "file", " ", 
     "is", " ", "present", "\[IndentingNewLine]", "5.", " ", "Setup", " ", 
     "Graph", " ", "Export", " ", "for", " ", "Local", " ", "User"}], " ", 
    "-", " ", "Done"}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQPeUHz0Y5ozeOGZn7doPoBOfSAyCadcHZJyBayku9
WhFIP3p1DEzb7Jn3BURXGP4E0ysfrnFUB9Kvl54A0xUva8tB9IQpP8F0g2fP
chDN82kFmG5z89sLoj+s6gTTTIxqDhpA+tcTUWcQfWDuu2wQXXPpfS6IjjZ8
0QLmR65oBdErTrstB9FR9ivAtNEl+TQtIP3i4iEw3cD7/I42kHZZo3MfRO/L
KffUBdLVTjO8QXTORJ8vnkD6m+StnyB6PnvGfR8gfU1k0nsQ3XLY2scXSMtc
OO0LopUK5xQvA9IGZXfBNADU34+x
  "],ExpressionUUID->"5e52de61-11ea-46ae-9a85-32700caaf500"]
},
WindowSize->{1278, 1348},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
Magnification:>1.3 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 77480, 1862, 8004, "Input",ExpressionUUID->"85e1a2a9-fb8b-45b8-96aa-0017df676a29"],
Cell[78041, 1884, 5042, 79, 138, "Input",ExpressionUUID->"75ff7eb9-df07-4eb2-bd2d-9da7b056d76b"],
Cell[83086, 1965, 5212, 106, 713, "Input",ExpressionUUID->"5e52de61-11ea-46ae-9a85-32700caaf500"]
}
]
*)

